<!-- Google tag (gtag.js) - Google Analytics 4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TXLR73WMYY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-TXLR73WMYY');
</script>

<!-- Enhanced Event Tracking -->
<script>
// Track form submissions
document.addEventListener('DOMContentLoaded', function() {
    // Track all form submissions
    const forms = document.querySelectorAll('form');
    forms.forEach(form => {
        form.addEventListener('submit', function(e) {
            const formType = form.dataset.formType || 'contact';
            const pageName = document.title.split('|')[0].trim();

            gtag('event', 'form_submit', {
                'event_category': 'Form',
                'event_label': formType,
                'page_title': pageName
            });

            // Track high-intent leads
            const intentScore = form.querySelector('[name="intent-score"]');
            if (intentScore && parseInt(intentScore.value) >= 15) {
                gtag('event', 'high_intent_lead', {
                    'event_category': 'Lead',
                    'event_label': 'High Intent',
                    'value': intentScore.value
                });
            }
        });
    });

    // Track phone number clicks
    const phoneLinks = document.querySelectorAll('a[href^="tel:"]');
    phoneLinks.forEach(link => {
        link.addEventListener('click', function() {
            gtag('event', 'phone_click', {
                'event_category': 'Contact',
                'event_label': 'Phone Call',
                'phone_number': this.href.replace('tel:', '')
            });
        });
    });

    // Track CTA button clicks
    const ctaButtons = document.querySelectorAll('.btn-primary, .submit-btn, .desktop-btn');
    ctaButtons.forEach(button => {
        button.addEventListener('click', function() {
            const buttonText = this.innerText || this.getAttribute('aria-label');
            gtag('event', 'cta_click', {
                'event_category': 'CTA',
                'event_label': buttonText,
                'page_title': document.title.split('|')[0].trim()
            });
        });
    });

    // Track external link clicks (Pay Invoice, Upload Files)
    const externalLinks = document.querySelectorAll('a[target="_blank"]');
    externalLinks.forEach(link => {
        link.addEventListener('click', function() {
            gtag('event', 'external_link_click', {
                'event_category': 'Outbound',
                'event_label': this.href,
                'link_text': this.innerText || this.getAttribute('aria-label')
            });
        });
    });
});
</script>

<!-- Metricool Tracking (COMMENTED OUT for dev - uncomment for production) -->
<!--
<script>function loadScript(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.src="https://tracker.metricool.com/resources/be.js",c.onreadystatechange=a,c.onload=a,b.appendChild(c)}loadScript(function(){beTracker.t({hash:"bde614a8fa68a6eb3126b87cd1a15ae8"})});</script>
-->
